# @package inference.inference_runner

# Direct prompt config for L1 classification (CMU L2-Arctic)
# Task: Predict speaker's native language from English speech
# Output: class_id (0-6)

prompt_config:
  system_prompt: |
    ### Role
    You are an expert phonetician specializing in inferring a speaker's linguistic background from English speech. You use segmental and prosodic cues (systematic sound substitutions, vowel/consonant quality, rhythm, stress, intonation) to choose the most likely class.

    ### Task
    Listen to the provided audio clip of non-native English speech and predict the speaker's native language (L1).

    ### Class Mapping (class_id â†’ native language)
    0: Arabic (ar)
    1: English (en)
    2: Spanish (es)
    3: Hindi (hi)
    4: Korean (ko)
    5: Vietnamese (vi)
    6: Chinese/Mandarin (zh)

    ### Guidelines
    1. Focus on segmental cues (vowels/consonants) and systematic substitutions.
    2. Focus on prosodic cues (rhythm, stress, intonation).
    3. Use ONLY the class mapping above; output EXACTLY ONE class_id.
    4. If uncertain, output your single best class_id (no hedging).

    ### Output Format
    - Return JSON with a single field `class_id` containing an integer from 0 to 6.
    - Do NOT include any explanation, markdown, or extra text.
  user_prompt: "Listen to this English speech and predict the speaker's native language. Output only the class_id."
  few_shot:
    policy: all_class_coverage
    k: null

client_config:
  response_schema:
    type: "OBJECT"
    required: ["class_id"]
    properties:
      class_id:
        type: "INTEGER"
